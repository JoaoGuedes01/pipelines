name: Run Guedesmoney CLI

on:
    workflow_dispatch:
        inputs:
            param1:
                    description: "Parameter 1"
                    required: true
                    default: true
                    type: boolean
            param2:
                description: "Parameter 2"
                required: true
                default: true
                type: boolean

jobs:
    build:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout code
              uses: actions/checkout@v2

            - name: Set up Python
              uses: actions/setup-python@v2
              with:
                python-version: 3.8

            - name: Install Guedesmoney
              run: |
                python -m pip install --upgrade pip
                pip install guedesmoney

            - name: Checking GuedesMoney version
              run: "guedesmoney version"
            
            - name: Configure GuedesMoney
              run: "guedesmoney config -un ${{secrets.GUEDESMOENY_USER_NIF}} -up ${{secrets.GUEDESMOENY_USER_PASSWORD}} -et ${{secrets.GUEDESMOENY_EMAIL_PROVIDER}} -se ${{secrets.GUEDESMOENY_EMAIL_SENDER}} -sp ${{secrets.GUEDESMOENY_SENDER_PASSKEY}} -rl ${{secrets.GUEDESMOENY_RECEPIENT_LIST}}"

            - name: Check GuedesMoney Configuration
              run: "guedesmoney config -c"
            
            - name: Running CLI
              run: |
                echo "Running CLI"
                guedesmoney run ${{ github.event.inputs.param1 == 'true' && '--param1' || '' }} ${{ github.event.inputs.param2 == 'true' && '--param2' || '' }}